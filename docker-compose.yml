version: '3.1'

services:
  myweb:
    image: apifrontend:1.0
    container_name: frontapi
    environment: 
      APIHOST: myapi
    depends_on: 
      - myapi
    ports: 
      - 8008:8008
    working_dir: /app/api

  myapi:
    image: laravel:1.0
    container_name: laravel
    ports:
      - 8000:8000
    depends_on: 
      - mydb
    volumes: 
      - .:/app
    working_dir: /app/api
    command: "php artisan serve --host=0.0.0.0 --port=8000"

  mydb:
    image: mysql:8
    container_name: mysqlc
    ports:
      - 3306:3306
    environment:
      MYSQL_DATABASE: data
      MYSQL_ROOT_USER: root
      MYSQL_ROOT_PASSWORD: 1234
      # MYSQL_ALLOW_EMPTY_PASSWORD: "true"
    volumes:
      - ./dbdata:/var/lib/mysql

  mydbadmin:
    image: phpmyadmin/phpmyadmin
    container_name: mydbadminc
    ports:
      - 8088:80
    environment:
      MYSQL_ROOT_PASSWORD: 1234
      PMA_HOST: mydb
      # MYSQL_ALLOW_EMPTY_PASSWORD: "true"
    depends_on:
      - mydb